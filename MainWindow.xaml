<Window x:Class="FolderDupFinder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ctrl="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
        Title="Folder Duplicates Finder" Height="980" Width="1350">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Action buttons -->
            <RowDefinition Height="Auto"/> <!-- Filter controls -->
            <RowDefinition Height="Auto"/> <!-- Input folders + progress bar -->
            <RowDefinition Height="*"/>   <!-- Main split area -->
        </Grid.RowDefinitions>

        <!-- ACTION BUTTONS -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10" Grid.Row="0">
            <ctrl:Button x:Name="btnAddFolder" Content="Add Folder"     Width="120" Margin="6" Click="AddFolder_Click"/>
            <ctrl:Button x:Name="btnRemoveFolder" Content="Remove Folder"  Width="120" Margin="6" Click="RemoveFolder_Click"/>
            <ctrl:Button x:Name="btnRunComparison" Content="Run Comparison" Width="140" Margin="6" Click="RunComparison_Click"/>
            <ctrl:Button x:Name="btnSaveProject" Content="Save Project"   Width="120" Margin="6" Click="SaveProject_Click"/>
            <ctrl:Button x:Name="btnLoadProject" Content="Load Project"   Width="120" Margin="6" Click="LoadProject_Click"/>
        </StackPanel>

        <!-- FILTER CONTROLS -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10" Grid.Row="1" >
            <ctrl:TextBlock Text="Min Size (MB):" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <ctrl:TextBox x:Name="txtMinSize" Width="60" Text="0" Margin="0,0,16,0" TextAlignment="Right" VerticalContentAlignment="Center"/>
            <ctrl:TextBlock Text="Min Similarity (%):" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <ctrl:TextBox x:Name="txtMinSimilarity" Width="60" Text="0" Margin="0,0,16,0" TextAlignment="Right" VerticalContentAlignment="Center"/>
            <ctrl:Button x:Name="btnApplyFilters" Content="Apply Filters" Width="100" Click="ApplyFilters_Click"/>
        </StackPanel>

        <!-- INPUT FOLDERS + PROGRESS BAR (side by side) -->
        <Grid Grid.Row="2" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <!-- Folders List -->
            <ctrl:GroupBox Header="Folders to Scan" Grid.Column="0" Height="160">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <ctrl:ListBox x:Name="listBoxFolders" MinWidth="250"/>
                </ScrollViewer>
            </ctrl:GroupBox>
            <!-- Spacer -->
            <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Center"/>
            <!-- Unified Progress Bar and Status -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0,0,0">
                <ctrl:ProgressBar x:Name="mainProgressBar" Width="300" Height="18" Margin="0,0,10,0"/>
                <ctrl:TextBlock x:Name="statusLabel" Text="Status: Idle" VerticalAlignment="Center"/>
            </StackPanel>
        </Grid>

        <!-- MAIN SPLIT AREA: Master candidates and details -->
        <Grid Grid.Row="3" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="6"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <!-- Master Candidates List -->
            <ctrl:ListView x:Name="listViewFolderMatches" Grid.Column="0" Margin="0,0,6,0" SelectionChanged="listViewFolderMatches_SelectionChanged">
                <ctrl:ListView.View>
                    <ctrl:GridView>
                        <ctrl:GridViewColumn Header="Master Folder" DisplayMemberBinding="{Binding Left}" Width="400"/>
                        <ctrl:GridViewColumn Header="Folder Name" DisplayMemberBinding="{Binding FolderName}" Width="180"/>
                        <ctrl:GridViewColumn Header="Similarity (%)" DisplayMemberBinding="{Binding Similarity, StringFormat=F2}" Width="120"/>
                        <ctrl:GridViewColumn Header="Size" DisplayMemberBinding="{Binding SizeDisplay}" Width="120"/>
                    </ctrl:GridView>
                </ctrl:ListView.View>
                <ctrl:ListView.Resources>
                    <Style TargetType="{x:Type GridViewColumnHeader}">
                        <EventSetter Event="Click" Handler="GridViewColumnHeader_Click"/>
                    </Style>
                </ctrl:ListView.Resources>
            </ctrl:ListView>
            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Center" VerticalAlignment="Stretch"/>
            <!-- Details Panel -->
            <ctrl:GroupBox Header="Details (Expand on Demand)" Grid.Column="2">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ctrl:TreeView x:Name="treeViewMatches" />
                </ScrollViewer>
            </ctrl:GroupBox>
        </Grid>
    </Grid>
</Window>
